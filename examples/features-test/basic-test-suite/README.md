# Basic Test Suite Example

## What This Demonstrates

This example shows a complete features test collection demonstrating all test types that the `features test` subcommand executes:

1. **Autogenerated Tests**: Per-feature `test.sh` scripts that validate basic installation
2. **Scenario Tests**: Named test configurations with custom base images and options
3. **Duplicate/Idempotence Tests**: Verify features can be installed twice without errors
4. **Global Scenarios**: Collection-wide tests in `test/_global/`

## Collection Structure

```
basic-test-suite/
├── src/
│   ├── hello-world/          # Simple greeting feature
│   │   ├── devcontainer-feature.json
│   │   └── install.sh
│   └── color-tools/          # Feature with options
│       ├── devcontainer-feature.json
│       └── install.sh
└── test/
    ├── hello-world/
    │   ├── test.sh           # Autogenerated test
    │   ├── scenarios.jsonc   # Scenario definitions
    │   └── test_*.sh         # Scenario test scripts
    ├── color-tools/
    │   ├── test.sh
    │   ├── scenarios.jsonc
    │   └── test_*.sh
    └── _global/              # Global scenarios
        ├── scenarios.jsonc
        └── test_*.sh
```

## DevContainer Specification References

This example implements testing concepts from the [DevContainer Specification](https://containers.dev/implementors/spec/):

- **[Features](https://containers.dev/implementors/spec/#features)**: Feature installation and lifecycle
- **[Feature Options](https://containers.dev/implementors/spec/#feature-options)**: Parameterized feature behavior
- **[Feature Testing](https://containers.dev/implementors/spec/#testing-features)**: Validation approaches for features

## Commands

```sh
# Run all tests (autogenerated, scenarios, duplicate/idempotence, global)
deacon features test .

# Run with JSON output
deacon features test . --json

# Run quietly (suppress non-error output)
deacon features test . --quiet

# Preserve test containers for debugging
deacon features test . --preserve-test-containers
```

## Expected Output

```text
Running features test suite...

Autogenerated Tests:
  ✓ hello-world
  ✓ color-tools

Duplicate/Idempotence Tests:
  ✓ hello-world (duplicate/idempotence)
  ✓ color-tools (duplicate/idempotence)

Scenario Tests:
  ✓ hello-world: default
  ✓ hello-world: alpine
  ✓ color-tools: with-red
  ✓ color-tools: with-blue

Global Scenarios:
  ✓ _global: sanity-check

Summary: 9 tests, 9 passed, 0 failed
```

## What Gets Tested

### Autogenerated Tests (`test.sh`)
- Verifies the feature's `install.sh` runs successfully
- Checks basic post-installation state

### Scenario Tests
- **hello-world: default** - Test on ubuntu:focal
- **hello-world: alpine** - Test on alpine:latest  
- **color-tools: with-red** - Test with `favoriteColor: "red"`
- **color-tools: with-blue** - Test with `favoriteColor: "blue"`

### Duplicate/Idempotence Tests
- Runs `install.sh` twice in the same container
- Ensures features handle re-installation gracefully

### Global Scenarios
- Collection-wide validation tests
- Run when no specific features are selected

## Why This Matters

Complete test coverage ensures:
- **Installation reliability**: Features install correctly across scenarios
- **Idempotence**: Features can be safely re-installed
- **Option handling**: Features respect configuration options
- **Cross-platform**: Features work on different base images
- **Regression prevention**: Changes don't break existing behavior

## Related Examples

- `feature-selection/` - Testing specific features only
- `scenario-filtering/` - Running specific scenarios
- `skip-test-types/` - Skipping certain test types
- `json-output/` - Structured output for CI/CD
