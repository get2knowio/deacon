# Feature Selection Example

## What This Demonstrates

This example shows how to use the `--features` flag to test only specific features from a collection, which is useful for:

- **Targeted testing**: Test only the features you've modified
- **CI optimization**: Run different feature subsets in parallel jobs
- **Incremental validation**: Test features as they're developed
- **Debugging**: Isolate specific features for troubleshooting

## Key Behavior

When you specify `--features`:
- Only the named features are tested (autogenerated, scenarios, duplicate tests)
- Global scenarios (`_global`) are **excluded** (unless `--global-scenarios-only` is also set)
- Non-matching features are skipped entirely

## Collection Structure

```
feature-selection/
├── src/
│   ├── git-tools/
│   ├── node-tools/
│   └── python-tools/
└── test/
    ├── git-tools/
    ├── node-tools/
    ├── python-tools/
    └── _global/
```

## Commands

```sh
# Test only git-tools
deacon features test . --features git-tools

# Test multiple specific features
deacon features test . --features git-tools python-tools

# Test a single feature with JSON output
deacon features test . --features node-tools --json
```

## Expected Output (--features git-tools)

```text
Running features test suite...

Autogenerated Tests:
  ✓ git-tools

Duplicate/Idempotence Tests:
  ✓ git-tools (duplicate/idempotence)

Scenario Tests:
  ✓ git-tools: ubuntu
  ✓ git-tools: debian

Summary: 4 tests, 4 passed, 0 failed

Note: Global scenarios excluded (use --global-scenarios-only to test them)
```

## What Gets Tested

### With `--features git-tools`:
- ✓ git-tools autogenerated test
- ✓ git-tools duplicate/idempotence test
- ✓ git-tools scenarios
- ✗ node-tools (skipped)
- ✗ python-tools (skipped)
- ✗ _global scenarios (excluded)

### With `--features git-tools python-tools`:
- ✓ git-tools (all test types)
- ✓ python-tools (all test types)
- ✗ node-tools (skipped)
- ✗ _global scenarios (excluded)

## Use Cases

### CI Pipeline Optimization
```yaml
# .github/workflows/test-features.yml
jobs:
  test-git:
    runs-on: ubuntu-latest
    steps:
      - run: deacon features test . --features git-tools --json
  
  test-node:
    runs-on: ubuntu-latest
    steps:
      - run: deacon features test . --features node-tools --json
  
  test-python:
    runs-on: ubuntu-latest
    steps:
      - run: deacon features test . --features python-tools --json
```

### Local Development
```sh
# You're working on git-tools, test only that
deacon features test . --features git-tools

# Made changes to both git-tools and python-tools
deacon features test . --features git-tools python-tools
```

## DevContainer Specification References

- **[Features](https://containers.dev/implementors/spec/#features)**: Feature distribution and installation
- **[Feature Dependencies](https://containers.dev/implementors/spec/#installsAfter)**: Feature ordering with installsAfter

## Related Examples

- `basic-test-suite/` - Complete test suite (all features)
- `scenario-filtering/` - Filter by scenario name
- `global-scenarios-only/` - Test only global scenarios
