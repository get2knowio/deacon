# Quickstart: Features Test

Run automated tests for your Dev Container Features collection.

## Prerequisites

- Your collection root has both `src/` and `test/` folders.
- Docker/compatible runtime is available on the host.

## Basic Usage

```bash
# Run full suite for collection in CWD
devcontainer features test --project-folder .

# Select specific features
devcontainer features test --project-folder . --features node python

# Only run global scenarios
devcontainer features test --project-folder . --global-scenarios-only

# Filter scenarios by name (case-sensitive substring)
devcontainer features test -p . --filter "basic"

# Skip scenario tests but keep autogenerated and duplicate checks
devcontainer features test -p . --skip-scenarios

# Preserve containers for inspection
devcontainer features test -p . --preserve-test-containers
```

## JSON Output Mode

```bash
devcontainer features test -p . --json > results.json
```

When `--json` is provided the command writes a single JSON array to stdout and writes all logs/diagnostics to stderr. The JSON array has the shape:

```json
[
  { "testName": "node", "result": true },
  { "testName": "node (duplicate/idempotence)", "result": true },
  { "testName": "python:basic", "result": false }
]
```

If zero tests are selected or discovered (after applying flags/filters), the command exits with code 0 and writes exactly `[]` to stdout (no other text). Any human-readable logs (for example, "No tests found") are written to stderr only.


## Invalid Combinations (Fail Fast)

- `--global-scenarios-only` with `--features` → argument error
- `--skip-scenarios` with `--global-scenarios-only` → argument error
- `--filter` with `--skip-scenarios` → argument error

## Cleanup Behavior

By default, test containers are labeled and removed after execution. To keep them, pass `--preserve-test-containers` and enumerate by label `devcontainer.is_test_run=true`.
