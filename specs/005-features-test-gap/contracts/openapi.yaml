openapi: 3.1.0
info:
  title: Dev Container Features Test API (Contract Doc)
  version: 0.1.0
  description: |
    Contract representation of the CLI `features test` behavior. Not a networked API.
    Describes inputs and outputs to ensure stable schemas for automation.
paths:
  /features/test/run:
    post:
      summary: Execute features test suite
      description: Runs autogenerated, scenario, and duplicate/idempotence tests per selection.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TestRunRequest'
      responses:
        '200':
          description: Test results
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/TestResult'
        '400':
          description: Invalid flags or missing structure
components:
  schemas:
    TestRunRequest:
      type: object
      properties:
        projectFolder:
          type: string
        features:
          type: array
          items:
            type: string
        filter:
          type: string
          description: Case-sensitive substring match on scenario names.
        globalOnly:
          type: boolean
        skipScenarios:
          type: boolean
        skipAutogenerated:
          type: boolean
        skipDuplicated:
          type: boolean
        permitRandomization:
          type: boolean
        baseImage:
          type: string
          default: ubuntu:focal
        remoteUser:
          type: string
        preserve:
          type: boolean
        quiet:
          type: boolean
        logLevel:
          type: string
          enum: [info, debug, trace]
      required: [projectFolder]
    TestResult:
      type: object
      properties:
        testName:
          type: string
        result:
          type: boolean
      required: [testName, result]
