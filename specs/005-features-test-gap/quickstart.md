# Quickstart: Features Test

Run automated tests for your Dev Container Features collection.

## Prerequisites

- Your collection root has both `src/` and `test/` folders.
- Docker/compatible runtime is available on the host.

## Basic Usage

```bash
# Run full suite for collection in CWD
devcontainer features test --project-folder .

# Select specific features
devcontainer features test --project-folder . --features node python

# Only run global scenarios
devcontainer features test --project-folder . --global-scenarios-only

# Filter scenarios by name (case-sensitive substring)
devcontainer features test -p . --filter "basic"

# Skip scenario tests but keep autogenerated and duplicate checks
devcontainer features test -p . --skip-scenarios

# Preserve containers for inspection
devcontainer features test -p . --preserve-test-containers
```

## JSON Output Mode

```bash
devcontainer features test -p . --json > results.json
```

When `--json` is provided, stdout contains exactly a JSON array of:

```json
[
  { "testName": "node", "result": true },
  { "testName": "node (duplicate)", "result": true },
  { "testName": "python:basic", "result": false }
]
```

Logs and diagnostics are written to stderr in all modes. If zero tests are selected/discovered, exit code is 0 and `--json` prints `[]`.

## Invalid Combinations (Fail Fast)

- `--global-scenarios-only` with `--features` → argument error
- `--skip-scenarios` with `--global-scenarios-only` → argument error
- `--filter` with `--skip-scenarios` → argument error

## Cleanup Behavior

By default, test containers are labeled and removed after execution. To keep them, pass `--preserve-test-containers` and enumerate by label `devcontainer.is_test_run=true`.
